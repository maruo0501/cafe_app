<h2 class="text-center mb-5">
  <% if user_signed_in? && @user == current_user %> 
    マイページ
  <% else %>
    ユーザー詳細
  <% end %>
</h2>
<div class="mx-auto" style="width: 300px;">
  <div class="user text-center mb-5">
  <!-- ユーザー画像も追加 --> 
    <% if @user.picture.present? %>
      <img src=<%= @user.picture %> class="rounded-circle">
    <% else %>
      <i class="fas fa-user-circle fa-7x"></i>
    <% end %>
    <h2><%= @user.name %></h2>
    <% if user_signed_in? && @user == current_user %>
      <%# <%= link_to "アカウント編集", edit_user_path(current_user) %> 
      <p><%= @user.email %></p>
      <%= link_to "アカウント編集", edit_user_registration_path %>
    <% end %>
  </div>
  <div class="border mb-4" style="padding:3px;">
    <div class="d-flex flex-row bd-highlight">
      <div class="p-2 bd-highlight"><%= link_to("投稿", "/users/#{@user.id}") %></div>
      <!-- お気に入り、コメントのリンクも追加 -->
      <div class="p-2 bd-highlight"><%= link_to("お気に入り", "/users/#{@user.id}/favorites") %></div>
      <div class="p-2 bd-highlight">コメント</div>
    </div>
  </div>
  <% @favorite_posts.each do |post| %>
  <%# <% @favorites.each do |favorite| %> 
    <div class="card mb-4">
      <% if post.image.present? %>
        <%= link_to image_tag(post.image_url, :size =>'299x200'), "/posts/#{post.id}" %>
      <% else %>
        <%= link_to image_tag('default.png', :size =>'299x200'), "/posts/#{post.id}" %> 
      <% end %>
      <div class="card-body">
        <h5 class="card-title"><%= link_to(post.store_name, "/posts/#{post.id}") %></h5>
          <h6 class="card-subtitle mb-2 text-muted">
            <% if post.wifi == "yes" %>
              <i class="fas fa-wifi"></i>
            <% end %>
            <% if post.power == "yes" %>
              <i class="fas fa-plug"></i>
            <% end %>
            <% if post.creditcard == "yes" %>
              <i class="far fa-credit-card"></i>
            <% end %>
          </h6>
        <p class="card-text"><%= post.content %></p>
      </div>
      <div class="card-footer">
        <div class="d-flex justify-content-start">
          <!-- お気に入り数表示 -->
          <% if user_signed_in? %>
            <% if post.favorited_by?(current_user) %> <!-- ログインしているユーザーがファボしたかどうかで分岐 -->
              <p>
                <%=link_to(post_favorites_path(post.id), method: :delete) do %>
                  <span><i class="fas fa-heart heart_red"></i></span>
                <% end %>
                <%= post.favorites.count %>
              </p>
            <% else %>
              <p>
                <%=link_to(post_favorites_path(post.id), method: :post) do %>
                  <span><i class="far fa-heart heart_red"></i></span>
                <% end %>
                <%= post.favorites.count %>
              </p>
            <% end %>
          <% else %>
            <p><span><i class="fas fa-heart heart_red"></i></span><%= post.favorites.count %></p> 
          <% end %>
          <!-- 投稿したユーザー名表示 -->
        <%# <div class="d-flex justify-content-end"> %>
          <% if @user.picture.present? %>
          <img src=<%= @user.picture %> class="rounded-circle mr-1">
          <% else %>
            <i class="fas fa-user-circle fa-2x mr-1"></i>
          <% end %>
          <%= link_to(@user.name, "/users/#{@user.id}") %>
        </div>
      </div>
    </div>
  <% end %>
</div>